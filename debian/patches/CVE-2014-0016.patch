Description: Reseed each forked child's random generator state
Origin: upstream
Author: Michal Trojnara <Michal.Trojnara@mirt.net>
Last-Update: 2014-03-06

--- a/src/stunnel.c
+++ b/src/stunnel.c
@@ -269,7 +269,9 @@
     s_log(LOG_DEBUG, "Service [%s] accepted (FD=%d) from %s",
         opt->servname, s, from_address);
     str_free(from_address);
-#ifndef USE_FORK
+#ifdef USE_FORK
+    RAND_add("", 1, 0.0); /* each child needs a unique entropy pool */
+#else
     if(max_clients && num_clients>=max_clients) {
         s_log(LOG_WARNING, "Connection rejected: too many clients (>=%d)",
             max_clients);
